AWSTemplateFormatVersion: "2010-09-09"
Description: "Setup AWS Security Hub"
Resources:
  SecurityHub:
    Type: "AWS::SecurityHub::Hub"
  SecurityHubStandardFoundationalBestPractices:
    Type: "AWS::SecurityHub::Standard"
    Properties:
      StandardsArn: arn:${AWS::Partition}:securityhub:${AWS::Region}::standards/aws-foundational-security-best-practices/v/1.0.0
  SecurityHubStandardCISFoundationsBenchmark:
    Type: "AWS::SecurityHub::Standard"
    Properties:
      StandardsArn: arn:${AWS::Partition}:securityhub:${AWS::Region}::standards/cis-aws-foundations-benchmark/v/1.4.0
Outputs:
  SecurityHubArn:
    Description: "The security hub ARN"
    Value: !Ref SecurityHub
    Export:
      Name: !Sub '${AWS::Region}-${AWS::StackName}-SecurityHubArn'
