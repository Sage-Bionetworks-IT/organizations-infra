AWSTemplateFormatVersion: '2010-09-09-OC'
Description: Manage AWS organizations with master account

Organization:
  MasterAccount:
    Type: OC::ORG::MasterAccount
    Properties:
      AccountName: organizations
      AccountId: '531805629419'
      RootEmail: aws.organizations@sagebase.org
      Alias: org-sagebase-organizations
      Tags:
        <<: !Include ./_default_org_tags.yaml

  OrganizationRoot:
    Type: OC::ORG::OrganizationRoot
    Properties:
      DefaultOrganizationAccessRoleName: OrganizationAccountAccessRole

  ScienceDevOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: ScienceDev
      Accounts:
        - !Ref SandboxAccount
        - !Ref MobileHealthDataEngineeringDevAccount
        - !Ref HtanDevAccount
        - !Ref NlpSandboxAccount
        - !Ref WorkflowsNextflowDevAccount
        - !Ref AgoraDevAccount
        - !Ref DnTDevAccount

  ScienceProdOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: ScienceProd
      Accounts:
        - !Ref ScicompAccount
        - !Ref iAtlasProdAccount
        - !Ref WorkflowsNextflowProdAccount
        - !Ref MobileHealthDataEngineeringProdAccount
        - !Ref CnbAccount
        - !Ref AgoraProdAccount
        - !Ref IncludeChopProdAccount

  PlatformOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: Platform
      OrganizationalUnits:
        - !Ref SynapseOU
        - !Ref BridgeOU

  ItDevOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: ItDev
      Accounts:
        - !Ref SceptreDevAccount
        - !Ref SaturnCloudDevAccount

  ItProdOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: ItProd
      Accounts:
        - !Ref TransitAccount
        - !Ref AdminCentralAccount
        - !Ref MasterAccount
        - !Ref LogCentralAccount
        - !Ref ImageCentralAccount
        - !Ref SecurityCentralAccount
        - !Ref IpamAccount

  PolicyStagingOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: PolicyStaging
      Accounts:
        - !Ref ITSandboxAccount

  ServiceCatalogOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: ServiceCatalog
      Accounts:
        - !Ref BmgfkiAccount
        - !Ref ScipoolDevAccount
        - !Ref ScipoolProdAccount

  SynapseOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: synapse
      Accounts:
        - !Ref SynapseDevAccount
        - !Ref SynapseDWAccount
        - !Ref SynapseProdAccount

  BridgeOU:
    Type: OC::ORG::OrganizationalUnit
    Properties:
      OrganizationalUnitName: bridge
      Accounts:
        - !Ref BridgeDevAccount
        - !Ref BridgeProdAccount

  <<: !Include ./_project-accounts.yaml